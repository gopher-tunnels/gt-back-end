{
  "openapi": "3.0.0",
  "info": {
    "version": "v1.0.0",
    "title": "GopherTunnels Backend Documentation",
    "description": "Route documentation for GopherTunnels Backend"
  },
  "servers": [
    {
      "url": "http://localhost:8000",
      "description": ""
    }
  ],
  "paths": {
    "/api/routing/route": {
      "get": {
        "description": "Returns a route plan between a starting location and destination. Examples of input parameters include \"Ford Hall\", \"Tate Hall\", \"Mondale Hall\"",
        "parameters": [
          {
            "in": "query",
            "name": "targetBuilding",
            "schema": {
              "type": "string",
              "example": "Ford Hall"
            },
            "required": true,
            "description": "Name of the target building to route to"
          },
          {
            "in": "query",
            "name": "latitude",
            "schema": {
              "type": "string",
              "example": "44.974887074686585"
            },
            "required": true,
            "description": "latitude of the user's location location"
          },
          {
            "in": "query",
            "name": "longitude",
            "schema": {
              "type": "string",
              "example": "-93.2353939947963"
            },
            "required": true,
            "description": "longitude of the user's location location"
          }
        ],
        "responses": {
          "default": {
            "description": ""
          },
          "200": {
            "description": "Returns a complete route from the user's location to the target building, including total distance and step-by-step path nodes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "route": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "buildingName": {
                            "type": "string",
                            "description": "The name of the building, if the node is part of one."
                          },
                          "latitude": {
                            "type": "number",
                            "format": "float",
                            "description": "Latitude coordinate of the node."
                          },
                          "longitude": {
                            "type": "number",
                            "format": "float",
                            "description": "Longitude coordinate of the node."
                          },
                          "floor": {
                            "type": "string",
                            "description": "Floor label of the node, if available."
                          },
                          "nodeType": {
                            "type": "string",
                            "description": "The type of node, such as 'building_node', 'path', or 'elevator'."
                          }
                        },
                        "required": ["latitude", "longitude", "nodeType"]
                      }
                    },
                    "totalDistance": {
                      "type": "number",
                      "format": "float",
                      "description": "Total distance of the computed route in meters."
                    }
                  },
                  "required": ["route", "totalDistance"]
                },
                "example": {
                  "route": [
                    {
                      "buildingName": "Smith Hall",
                      "latitude": 44.974469519336964,
                      "longitude": -93.23601030905132,
                      "floor": "SB",
                      "nodeType": "building_node"
                    }
                  ],
                  "totalDistance": 563.55
                }
              }
            }
          }
        }
      }
    },
    "/api/routing/popular": {
      "get": {
        "description": "Returns the top 5 most popular destinations from a single start location. Sorted by popularity. Highest is first",
        "responses": {
          "default": {
            "description": ""
          },
          "200": {
            "description": "Returns an array of all buildings ordered based on visits from highest first to lowest last",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/routing/search": {
      "get": {
        "description": "Provide search bar functionality for the frontend",
        "parameters": [
          {
            "in": "query",
            "name": "input",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "Input parameter from search bar"
          }
        ],
        "responses": {
          "default": {
            "description": ""
          }
        }
      }
    },
    "/api/routing/buildings": {
      "get": {
        "description": "Retrieve all building nodes and their information from the database",
        "responses": {
          "default": {
            "description": ""
          },
          "200": {
            "description": "Returns an array of all building nodes with their names, coordinates, visit count, floor, and ID.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "building_name": { "type": "string" },
                      "visits": { "type": "number" },
                      "x": { "type": "number" },
                      "y": { "type": "number" }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error. Failed to fetch buildings from database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "object",
                      "properties": {
                        "message": { "type": "string", "example": "Error fetching buildings from database" },
                        "status": { "type": "integer", "example": 500 },
                        "details": {
                          "type": "object",
                          "properties": {
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/routing/routes": {
      "get": {
        "description": "Returns a route plan between a starting location and destination. Examples of input parameters include \"Ford Hall\", \"Tate Hall\", \"Mondale Hall\"",
        "parameters": [
          {
            "in": "query",
            "name": "startLat",
            "schema": {
              "type": "number"
            },
            "required": true,
            "description": "Starting latitude to route from"
          },
          {
            "in": "query",
            "name": "startLong",
            "schema": {
              "type": "number"
            },
            "required": true,
            "description": "Starting longtitude to route from"
          },
          {
            "in": "query",
            "name": "target",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "the destination"
          }
        ]
    }
  }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}